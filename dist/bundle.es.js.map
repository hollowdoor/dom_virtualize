{"version":3,"file":"bundle.es.js","sources":["../src/index.js"],"sourcesContent":["import { toElement } from 'dom-elementals';\n\nclass Virtualize {\n    constructor({\n        frame = document.createElement('div'),\n        parent = document.createElement('div'),\n        render = null,\n        classes = {}\n    }){\n        frame.style.width = '500px';\n        frame.style.height = '400px';\n        frame.style.border = '1px solid black';\n        const self = this;\n        frame.appendChild(parent);\n\n        this.data = [];\n        this.element = frame;\n        this._parent = parent;\n        this._render = render;\n        this.indexes = {\n            top: 0,\n            bottom: 0\n        };\n\n        let last = this.last = document.createElement('div');\n        last.style.width = '100%';\n        last.style.hight = '0px';\n        last.style.margin = '';\n        last.style.padding = '';\n        frame.style.overflow = 'scroll';\n\n        /*let {\n            last = 'dom-virtualize-last'\n        } = (classes || {});\n\n        classes = this.classes = {\n            last\n        };*/\n\n        function onScroll(event){\n            self.expand();\n        }\n\n        parent.addEventListener('scroll', onScroll);\n\n        this.destroy = function(){\n            parent.removeEventListener('scroll', onScroll);\n        };\n    }\n    expand(){\n        let rect = this.last.getBoundingClientRect();\n        let outer = this.element.getBoundingClientRect();\n        let parent = this._parent;\n        let bottom = this.indexes.bottom;\n        if(rect.top >= outer.bottom){\n            for(let i=this.indexes.bottom; i<this.data.length; i++){\n                rect = this.last.getBoundingClientRect();\n                if(rect.top >= outer.bottom){\n                    console.log('this.data[i] ',this.data[i])\n                    let el = toElement(this._render(this.data[i]));\n                    parent.appendChild(el);\n                    bottom = i;\n                }\n\n            }\n            this.indexes.bottom = bottom;\n\n        }\n    }\n    push(...data){\n        this.data = this.data.concat(data);\n        this.expand();\n    }\n    appendTo(dest){\n        console.log('dest ',dest)\n        try{\n\n            dest.appendChild(this.element);\n        }catch(e){ console.error(e)}\n    }\n}\n\nexport default function virtualize(options){\n    return new Virtualize(options);\n}\n"],"names":["let","this"],"mappings":"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"}